% ==
%         TEMPLATE LaTeX Pandoc - XeLaTeX Modern (2025)
% ======================================================================

\documentclass[11pt, a4paper]{article}

% ------------------------------------------------------
% FONTS (Best practice for XeLaTeX)
% ------------------------------------------------------
\usepackage{fontspec}
% Polices TeX Gyre (nécessitent installation via MiKTeX)
% Alternative: polices système Windows (décommentez si TeX Gyre non disponible)
\setmainfont{TeX Gyre Pagella}      % Texte
\setsansfont{TeX Gyre Heros}        % Sans serif
\setmonofont{Courier New}[Scale=0.9]   % Code (toujours disponible sur Windows)

% Alternative système Windows:
% \setmainfont{Times New Roman}
% \setsansfont{Arial}
% \setmonofont{Courier New}[Scale=0.9]


% ------------------------------------------------------
% SYMBOLES MATHÉMATIQUES
% ------------------------------------------------------
\usepackage{amssymb}  % Pour \square et autres symboles
\usepackage{amsmath}  % Pour les mathématiques

% ------------------------------------------------------
% TABLEAUX
% ------------------------------------------------------
% Configuration spéciale pour éviter les erreurs avec Pandoc
\usepackage{array}      % Améliorations des tableaux
\usepackage{booktabs}   % Pour de beaux tableaux
\setlength{\heavyrulewidth}{1.2pt}  % Lignes plus épaisses pour les tableaux
\setlength{\lightrulewidth}{0.5pt}

% Définir les compteurs AVANT longtable (important pour Pandoc)
\makeatletter
\@ifundefined{c@table}{\newcounter{table}}{}
% Définir le compteur 'none' pour éviter l'erreur quand Pandoc utilise \LTcaptype{none}
\@ifundefined{c@none}{\newcounter{none}}{}
\makeatother

\usepackage{longtable}  % Pour les tableaux sur plusieurs pages
\setlength{\LTcapwidth}{\textwidth}
\setlength{\LTleft}{0pt}
\setlength{\LTright}{0pt}
% Note: Pandoc utilise parfois \LTcaptype{none} pour éviter d'incrémenter le compteur

% ------------------------------------------------------
% MICROTYPOGRAPHIE
% ------------------------------------------------------
\usepackage{microtype}


% ------------------------------------------------------
% COULEURS & CODAGE DES LIENS
% ------------------------------------------------------
\usepackage{xcolor}

% Palette de couleurs moderne
\definecolor{primaryblue}{HTML}{2563EB}      % Bleu principal
\definecolor{secondaryblue}{HTML}{3B82F6}   % Bleu secondaire
\definecolor{accentpurple}{HTML}{7C3AED}    % Violet accent
\definecolor{successgreen}{HTML}{10B981}    % Vert succès
\definecolor{warningorange}{HTML}{F59E0B}   % Orange avertissement
\definecolor{errorred}{HTML}{EF4444}         % Rouge erreur
\definecolor{codebg}{RGB}{248,250,252}      % Fond code clair
\definecolor{codeborder}{RGB}{226,232,240}  % Bordure code
\definecolor{sectioncolor}{HTML}{1E40AF}    % Couleur sections
\definecolor{subsectioncolor}{HTML}{3B82F6} % Couleur sous-sections

% Couleurs pour les liens
\definecolor{linkcolor}{HTML}{2563EB}
\definecolor{urlcolor}{HTML}{3B82F6}
\definecolor{citecolor}{HTML}{7C3AED}

\usepackage[
    colorlinks=true,
    linkcolor=linkcolor,
    urlcolor=urlcolor,
    citecolor=citecolor,
    pdfborder={0 0 0}
]{hyperref}


% ------------------------------------------------------
% GEOMETRIE & ESPACEMENT
% ------------------------------------------------------
\usepackage[a4paper, margin=2.5cm]{geometry}
\setlength{\parskip}{0.6em}
\setlength{\parindent}{0pt}


% ------------------------------------------------------
% TITRE PANDOC
% ------------------------------------------------------
\usepackage{titling}
\pretitle{\begin{center}\LARGE\bfseries\color{sectioncolor}\vspace{1em}}
\posttitle{\par\vspace{0.5em}\rule{0.6\textwidth}{1.5pt}\end{center}\vspace{1em}}

$if(title)$
    \title{$title$}
$endif$

$if(subtitle)$
    \preauthor{\begin{center}\large\color{subsectioncolor}}
    \postauthor{\end{center}}
$endif$

$if(author)$
    \author{$for(author)$$author$$sep$ \\ $endfor$}
$endif$

$if(date)$
    \predate{\begin{center}\small\color{gray!60}}
    \postdate{\end{center}}
    \date{$date$}
$else$
    \date{}
$endif$


% ------------------------------------------------------
% TABLE OF CONTENTS
% ------------------------------------------------------
\usepackage{tocloft}
\setlength{\cftbeforesecskip}{6pt}
\setlength{\cftbeforesubsecskip}{3pt}
\renewcommand{\cftsecfont}{\color{sectioncolor}\bfseries}
\renewcommand{\cftsubsecfont}{\color{subsectioncolor}}
\renewcommand{\cftsecpagefont}{\color{sectioncolor}\normalfont}
\renewcommand{\cftsubsecpagefont}{\color{subsectioncolor}\normalfont}
\renewcommand{\cftdotsep}{2}

% ------------------------------------------------------
% STYLE DES TITRES
% ------------------------------------------------------
\usepackage{titlesec}
% Sections avec style moderne
\titleformat{\section}
  {\Large\bfseries\color{sectioncolor}}
  {\thesection}{0.8em}{}
\titlespacing*{\section}{0pt}{2em}{1.2em}

% Sous-sections avec style moderne
\titleformat{\subsection}
  {\large\bfseries\color{subsectioncolor}}
  {\thesubsection}{0.8em}{}
\titlespacing*{\subsection}{0pt}{1.5em}{0.8em}

% Sous-sous-sections
\titleformat{\subsubsection}
  {\normalsize\bfseries\color{accentpurple}}
  {\thesubsubsection}{0.8em}{}
\titlespacing*{\subsubsection}{0pt}{1.2em}{0.6em}

% ------------------------------------------------------
% LISTES (Pandoc good practice)
% ------------------------------------------------------
% Pour éviter le warning \tightlist
\providecommand{\tightlist}{\setlength{\itemsep}{0.3em}\setlength{\parskip}{0pt}}

% Amélioration des listes
\usepackage{enumitem}
\setlist{leftmargin=1.5em, itemsep=0.3em, topsep=0.5em}
\setlist[itemize]{label=\textcolor{sectioncolor}{\textbullet}}
\setlist[enumerate]{label=\textcolor{sectioncolor}{\arabic*.}}

% Style pour les séparateurs horizontaux (gérés par Pandoc automatiquement)


% ------------------------------------------------------
% CODE HIGHLIGHTING (Pandoc - avec framed environ.)
% ------------------------------------------------------
\usepackage{fvextra}      % améliore verbatim
\usepackage{minted}       % si Python disponibles, sinon fallback
\usepackage{framed}

% Boîtes colorées pour le code
\usepackage{tcolorbox}
\tcbuselibrary{breakable,skins,listings}
\tcbset{
  codebox/.style={
    colback=codebg,
    colframe=codeborder,
    boxrule=1pt,
    arc=4pt,
    left=8pt,
    right=8pt,
    top=6pt,
    bottom=6pt,
    breakable,
    enhanced,
    fonttitle=\bfseries\small\color{sectioncolor}
  }
}

% Style pour les blockquotes (notes importantes)
\newtcolorbox{blockquote}{
  colback=codebg!50,
  colframe=warningorange,
  boxrule=0.8pt,
  arc=3pt,
  left=10pt,
  right=10pt,
  top=8pt,
  bottom=8pt,
  before skip=1em,
  after skip=1em,
  fonttitle=\bfseries\small\color{warningorange}
}

% ------------------------------------------------------
% SUPPORT PANDOC CODE HIGHLIGHTING (Highlighting)
% ------------------------------------------------------

% Environment used by Pandoc for syntax highlighting
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{
  commandchars=\\\{\},
  breaklines,
  breakanywhere
}

% Environnement Shaded amélioré pour Pandoc
\definecolor{shadecolor}{RGB}{248,250,252}
\newenvironment{Shaded}{%
  \begin{tcolorbox}[codebox]
}{%
  \end{tcolorbox}
}

% Définitions des commandes de coloration syntaxique Pandoc
% (utilisées quand Pandoc génère du code avec coloration - couleurs améliorées)
\newcommand{\NormalTok}[1]{#1}
\newcommand{\AlertTok}[1]{\textcolor{errorred}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor{warningorange}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor{warningorange}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor{accentpurple}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor{secondaryblue}{#1}}
\newcommand{\CharTok}[1]{\textcolor{successgreen}{#1}}
\newcommand{\CommentTok}[1]{\textcolor{gray!70}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor{gray!60}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor{accentpurple}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor{primaryblue}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor{accentpurple}{#1}}
\newcommand{\DecValTok}[1]{\textcolor{accentpurple}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor{gray!70}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor{errorred}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{\textcolor{secondaryblue}{#1}}
\newcommand{\FloatTok}[1]{\textcolor{accentpurple}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor{primaryblue}{#1}}
\newcommand{\ImportTok}[1]{\textcolor{secondaryblue}{#1}}
\newcommand{\InformationTok}[1]{\textcolor{secondaryblue}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor{primaryblue}{\textbf{#1}}}
\newcommand{\OperatorTok}[1]{\textcolor{errorred}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor{gray!60}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor{gray!70}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor{accentpurple}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor{successgreen}{#1}}
\newcommand{\StringTok}[1]{\textcolor{successgreen}{#1}}
\newcommand{\VariableTok}[1]{\textcolor{accentpurple}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor{successgreen}{#1}}
\newcommand{\WarningTok}[1]{\textcolor{warningorange}{\textbf{\textit{#1}}}}
\newcommand{\CommandTok}[1]{\textcolor{primaryblue}{\textbf{#1}}}
\newcommand{\CharNumTok}[1]{\textcolor{accentpurple}{#1}}

% ------------------------------------------------------
% IMAGES
% ------------------------------------------------------
\usepackage{graphicx}
\usepackage{float}
\graphicspath{{./}}

% ------------------------------------------------------
% HEADER / FOOTER
% ------------------------------------------------------
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{1pt}
\renewcommand{\footrulewidth}{0.8pt}
\fancyhead[L]{\small\color{sectioncolor}\leftmark}
\fancyhead[R]{\small\color{subsectioncolor}\rightmark}
\fancyfoot[C]{\small\color{sectioncolor}\bfseries\thepage}
\fancyfoot[L]{\small\color{gray!50}}
\fancyfoot[R]{\small\color{gray!50}}


% ======================================================================
% DOCUMENT
% ======================================================================

\makeatletter
\let\LT@cap\relax
\providecommand{\LT@captype}{table}
\makeatother


\begin{document}

$if(title)$
\maketitle
$endif$

$if(toc)$
{
\setcounter{tocdepth}{2}
\tableofcontents
\newpage
}
$endif$

$body$

\end{document}



