# Optimiser $f(x,y)=xy-2y$ par la contrainte $g(x,y)=0$ où $g(x,y)=x-y^2+1$

On considère $f$ définie sur $\mathbb{R}^2$ par $f(x,y)=xy-2y$ soumise à la contrainte $x-y^2+1=0$, on résout le problème d'optimisation :

$$
\begin{aligned}
f(x,y) &= xy-2y \\
g(x,y) &= x-y^2+1
\end{aligned}
$$

$$
\mathcal{L}(x,y,\lambda)=f(x,y)+\lambda g(x,y)=(xy-2y)+\lambda(x-y^2+1)
$$

$$
\nabla \mathcal{L}(x,y,\lambda)=\begin{cases}
\frac{\partial \mathcal{L}}{\partial x}= y+\lambda=0 & \implies y=-\lambda \\
\frac{\partial \mathcal{L}}{\partial y}= x-2-2y=0 & \implies (\lambda^2-1)-2-2\lambda(-\lambda)=0 \\
\frac{\partial \mathcal{L}}{\partial \lambda}= x-y^2+1=0 & \implies x=y^2-1=(-\lambda)^2-1=\lambda^2-1
\end{cases}
$$

$$
\begin{aligned}
\lambda^2-1-2+2\lambda^2 &= 0 \\
3\lambda^2 &= 3 \\
\lambda^2=1 &\implies \lambda=\pm1
\end{aligned}
$$

***
## Cas $\lambda=1$
$$
\begin{aligned}
y &= -1 \\
x &= (-1)^2-1=0 \\
\implies & (x=0;\; y=1;\; \lambda=1)
\end{aligned}
$$

## Cas $\lambda=-1$
$$
\begin{aligned}
y &= 1 \\
x &= (-1)^2-1=0 \\
\implies & (x=0,\; y=1,\; \lambda=-1)
\end{aligned}
$$

$$
\nabla g(x,y)=\begin{cases}
\frac{\partial g}{\partial x}=1 \\
\frac{\partial g}{\partial y}=-2y
\end{cases}
$$

$$
\begin{aligned}
\nabla g(0,-1) &= (1,2) \neq (0,0) \\
\nabla g(0,1) &= (1,-2) \neq (0,0)
\end{aligned}
$$

## Cas $\lambda=1$:
$$
\mathcal{L}(x,y,1)=(xy-2y)+(x-y^2+1)
$$

$$
\begin{array}{c|c|c}
\frac{\partial \mathcal{L}}{\partial x}=y+1 & \frac{\partial^2\mathcal{L}}{\partial x^2}=0 & \frac{\partial^2 \mathcal{L}}{\partial x \partial y}=\frac{\partial^2\mathcal{L}}{\partial y \partial x} \\
\frac{\partial \mathcal{L}}{\partial y}=x-2-2y & \frac{\partial^2\mathcal{L}}{\partial y^2}=-2 &
\end{array}
$$

$$
\begin{aligned}
\frac{\partial^2\mathcal{L}}{\partial x \partial y} &= \frac{\partial}{\partial x}\left(\frac{\partial \mathcal{L}}{\partial y}\right)=\frac{\partial}{\partial x}(x-2-2y)=1 \\
\frac{\partial^2\mathcal{L}}{\partial y \partial x} &= \frac{\partial}{\partial y}\left(\frac{\partial \mathcal{L}}{\partial x}\right)=\frac{\partial}{\partial y}(y+1)=1
\end{aligned}
$$

$$
\text{Hess}\mathcal{L}(x,y)=\begin{pmatrix}
\frac{\partial^2 \mathcal{L}}{\partial x^2} & \frac{\partial^2 \mathcal{L}}{\partial x \partial y} \\
\frac{\partial^2 \mathcal{L}}{\partial y \partial x} & \frac{\partial^2 \mathcal{L}}{\partial y^2}
\end{pmatrix}
= \begin{pmatrix}
0 & 1 \\
1 & 2
\end{pmatrix}
$$

$$
\det(\text{Hess}\mathcal{L}) = -1 < 0
$$

$$
\text{HB}_{\mathcal{L}}(x,y,\lambda)=\begin{pmatrix}
\frac{\partial^2\mathcal{L}}{\partial x^2} & \frac{\partial^2\mathcal{L}}{\partial x \partial y} & \frac{\partial g}{\partial x} \\
\frac{\partial^2\mathcal{L}}{\partial y \partial x} & \frac{\partial^2\mathcal{L}}{\partial y^2} & \frac{\partial g}{\partial y} \\
\frac{\partial g}{\partial x} & \frac{\partial g}{\partial y} & 0
\end{pmatrix}
$$

$$
\mathcal{L}(x,y,\lambda)=f(x,y)+\lambda g(x,y)=(xy-2y)+\lambda(x-y^2+1)
$$

$$
\begin{aligned}
\frac{\partial \mathcal{L}}{\partial x}=y+\lambda &\implies \frac{\partial^2 \mathcal{L}}{\partial x^2}=0 \\
\frac{\partial \mathcal{L}}{\partial y}=x-2-2\lambda y &\implies \frac{\partial^2 \mathcal{L}}{\partial y^2}=-2\lambda
\end{aligned}
$$

$\mathcal{L}$ est $\mathcal{C}^2$ sur $\mathbb{R}^2$ donc $\frac{\partial^2 \mathcal{L}}{\partial x \partial y}=\frac{\partial^2\mathcal{L}}{\partial y \partial x}=\frac{\partial}{\partial x}\left(\frac{\partial \mathcal{L}}{\partial y}\right)=\frac{\partial}{\partial x}(x-2-2\lambda y)=1$

$$
\frac{\partial^2 \mathcal{L}}{\partial y \partial x}=\frac{\partial}{\partial y}(y+\lambda)=1
$$

Pour $(x=0;\; y=1;\; \lambda=-1)$ :
$$
\text{HB}(0,1,-1)=\begin{pmatrix}
0 & 1 & 1 \\
1 & 2 & -2 \\
1 & -2 & 0
\end{pmatrix}
$$

$$
\begin{aligned}
\det\text{HB}(0,1,-1) &= \begin{vmatrix}
0 & 1 & 1 \\
1 & 2 & -2 \\
1 & -2 & 0
\end{vmatrix} \\\\
&= (-1)\begin{vmatrix}
1 & 2 \\
1 & 0
\end{vmatrix} + 1\begin{vmatrix}
1 & 2 \\
1 & -2
\end{vmatrix} \\\\
&= (-1)(2) + (-2-2) \\ \\
&= -2 - 4 = -6 < 0
\end{aligned}
$$
***

# Optimiser $f(x,y)=-x^2+xy$ sous la contrainte $g(x,y)=20$ où $g(x,y)=2x+y$

$$\mathcal{L}(x,y,\lambda)=f(x,y)+\lambda g(x,y)=(-x^2+xy)+\lambda(2x+y-20)$$
Les points critiques sont : $(x,y,\lambda)=\left( \frac{10}{3},\frac{40}{3}, \frac{10}{3} \right)$
La nature de ce point critique :

- Commençant d'abord par vérifier que $\nabla g\left( \frac{10}{3}, \frac{40}{3} \right)\neq 0$ ce qui est le cas car $\nabla g(x,y)=(2,1)\neq(0,0) \forall ((x,y) \in \mathbb{R}^2$
  
- L'application de la caractérisation faible ne permet pas de conclure car on trouve que $r=-2$, $t=0$ et $s=1$, ainsi on  est face à un point selle pour $\mathcal{L}(x,y,-\frac{10}{3})$
  
- On applique la caractérisation forte des points critiques, on a :  
  $$\text{HB}_{\mathcal{L}}\left( \frac{10}{3},\frac{40}{3}    , -\frac{10}{3} \right)=\left( \begin{array}{ccc}
     -2 & 1 & 2 \\
     1 & 0 & 1 \\
     2 & 1 & 0
    \end{array} \right)$$

On a $\det\left( \text{HB}_{\mathcal{L}}\left( \frac{10}{3}, \frac{40}{3},-\frac{10}{3} \right) \right)=6>0$, ainsi on a un point $\left( \frac{10}{3},\frac{40}{3} \right)$ est un maximum de $f$ associé au multiplicateur $\lambda=-\frac{10}{3}$

***
# Optimiser la production $(x,y)$ sous contraintes de lait et d’heures de travail

Une laiterie fabrique 2 fromages : le premier est un AOC demandant plus d'heure de travail et un lait en provenance d'une région bien précise. Le second est ordinaire, peut être fabriqué avec n'importe quel lait, sa vente dégage une marge moindre.

La laiterie a 21000 heures de travail annuel, reçoit 4 millions de litre de lait de la zone AOC et 6 millions d'autres zones. Nous avons également les informations suivantes : 

- Une tonne de fromage AOC nécessite 30 heures de travail et10 000 litres de lait
  
- Une tonne de fromage ordinaire nécessite 15 heures de travail et 7 500 litres de lait
  
- Un kg de fromage AOC dégage une marge de 3€ alors qu'un fromage ordinaire va en dégager 1€
  
Quelle production doit fabriquer cette laiterie pour maximiser ses bénéfices ?

On pose $x$ et $y$ respectivement les quantités en termes de tonnages du fromage AOC et fromage ordinaire ) fabriquer. Il faut alors que la fonction $f(x,y)=3x+y$, sous les contraintes suivantes :

- $10000x<4000000$
  
- $7500y<10000000-10000x$
  
- $30x+15y\leq 21000$
  
- Les quantités à produire doivent être positives

D'où le système d'inéquations suivant (après simplifications) : 

$$\begin{cases}
x\leq 400 \\
4x+3y\leq 4000 \\
2x+y\leq 1400 \\
x\geq 0 \\
y\geq 0
\end{cases}$$


